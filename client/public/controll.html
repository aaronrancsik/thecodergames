<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Controll</title>
    <link rel="stylesheet" href="./res/bootstrap.min.css">
</head>
<body>
    <div class="container">
            <button onclick="btLoadMap()">Load Map</button>
            <button onclick="btGetUsers()">Get Users</button>
            <button onclick="btInspectUser()">Inspect user</button>
            <button onclick="btPlay()">Play</button>

            <br>

            <input id="txSelectedMap" type="text" >
            <label for="txSelectedMap">Selected Map</label>
            <br>
            <input id="txSelectedUser" type="text" readonly>
            <label for="txSelectedUser">Selected User</label>

            

            <div class="container">
                <div class="row">
                    <div class="col-xs-6">
                        <div class="list-group">
                            <button onclick="select('')" type="button" class="list-group-item list-group-item-action active">ResetUsserSelect</button>
                            <div id="listcont"></div>
                        </div>
                    </div>
                    
                </div>
            </div>
            
    </div>
    
    <script src="./res/jquery-3.3.1.min.js"></script>
    <script src="./res/bootstrap.min.js"></script>
    <script src="./res/socket.io.dev.js"></script>
    <script>
        var socket = io({query: {token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiY29udHJvbGxlciIsImlhdCI6MTUzNzkxOTQ0OH0.y1TURyu7FX7z9snsvuTgBhhvSS_ysEIro89n02k1LuA"}});
        function btPlay(){
            if(userFiled.value!=""){
                socket.emit("playGame", {play:true});
            }else{
                alert("nincs user valasztva");
            }
            
        }
        function btGetUsers(){
            
            socket.emit("getUsers");
        }
        var mapField = document.getElementById("txSelectedMap");
        function btLoadMap(){
            socket.emit("changeMap",{map:mapField.value});
        }
        function btInspectUser(){
            
            socket.emit("inspectUser", {"username" : userFiled.value} );
            
        }
        var userFiled = document.getElementById("txSelectedUser");
        function select(userName){
            userFiled.value = userName ;
        }
        var listcont = document.getElementById("listcont");
        socket.on("updateUserList",(m)=>{
            listcont.innerHTML="";
            m.users.forEach(element => {
                listcont.innerHTML+='<button onclick="select('+"'"+element.name+"'"+')" type="button" class="list-group-item list-group-item-action">'+element.name+'</button>'
            });
        });
        
    </script>
</body>
</html>
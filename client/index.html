<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Blockly Demo: Resizable Blockly (Part 2)</title>
  <script src="./blockly/blockly_compressed.js"></script>
  <script src="./blockly/blocks_compressed.js"></script>
  <script src="./blockly/javascript_compressed.js"></script>
  <script src="./blockly/msg/js/en.js"></script>
  <link rel="stylesheet" href="./res/style.css">
</head>
<body>
  <table>
    <tr>
      <td id="blocklyArea">
      </td>
    </tr>
  </table>
  <!--https://blockly-demo.appspot.com/static/demos/blockfactory/index.html#cwekm4 -->
  <div id="blocklyDiv" style="position: absolute"></div>

  <xml id="toolbox" style="display: none">
      <category name="Add" colour="%{BKY_LOGIC_HUE}">
        <block type="leftstep"></block>
        <block type="rightstep"></block>
        <block type="controls_if"></block>
        <block type="logic_compare"></block>
        <block type="logic_operation"></block>
        <block type="logic_negate"></block>
        <block type="logic_boolean"></block>
        <block type="controls_repeat_ext">
          <value name="TIMES">
            <block type="math_number">
              <field name="NUM">10</field>
            </block>
          </value>
        </block>
        <block type="controls_whileUntil"></block>
        <block type="math_number">
          <field name="NUM">123</field>
        </block>
        <block type="math_arithmetic"></block>
        <block type="math_single"></block>
        <block type="text"></block>
        <block type="text_length"></block>
        <block type="text_print"></block>
      </category>
    </xml>

  <script>
    var blocklyArea = document.getElementById('blocklyArea');
    var blocklyDiv = document.getElementById('blocklyDiv');
    var workspace = Blockly.inject(
        blocklyDiv,
        { media: './blockly/media/',
          toolbox: document.getElementById('toolbox'),
          zoom:{
            controls: true,
            wheel: false,
            startScale: 2,
            maxScale: 6,
            minScale: 0.3,
            scaleSpeed: 1.2
         },
          trashcan: true,
          grid:
          {spacing: 20,
            length: 3,
            colour: '#ccc',
            snap: false},
        });
    var onresize = function(e) {
      // Compute the absolute coordinates and dimensions of blocklyArea.
      var element = blocklyArea;
      var x = 0;
      var y = 0;
      do {
        x += element.offsetLeft;
        y += element.offsetTop;
        element = element.offsetParent;
      } while (element);
      // Position blocklyDiv over blocklyArea.
      blocklyDiv.style.left = x + 'px';
      blocklyDiv.style.top = y + 'px';
      blocklyDiv.style.width = blocklyArea.offsetWidth + 'px';
      blocklyDiv.style.height = blocklyArea.offsetHeight + 'px';
      Blockly.svgResize(workspace);
    };

    /*
    Custom Blocks
    */

    window.addEventListener('resize', onresize, false);
    onresize();
    Blockly.Blocks['leftstep'] = {
      init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("Balra lépés");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(75);
        this.setTooltip("");
        this.setHelpUrl("");
      }
    };
    Blockly.JavaScript['leftstep'] = function(block) {
      // TODO: Assemble JavaScript into code variable.
      var code = 'leftStep()';
      return code;
    };
    Blockly.Blocks['rightstep'] = {
      init: function() {
        this.appendDummyInput()
            .setAlign(Blockly.ALIGN_RIGHT)
            .appendField("Jobbra lépés");
        this.setPreviousStatement(true, null);
        this.setNextStatement(true, null);
        this.setColour(75);
    this.setTooltip("");
    this.setHelpUrl("");
      }
    };
    Blockly.JavaScript['rightstep'] = function(block) {
      // TODO: Assemble JavaScript into code variable.
      var code = 'rightstep()';
      return code;
    };





    Blockly.svgResize(workspace);
  </script>
</body>
</html>
